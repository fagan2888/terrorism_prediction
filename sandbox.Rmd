---
title: "R Notebook"
output:
  pdf_document: default
  html_notebook: default
---

This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code. 

What does Ljung box-statistic do; should they be significant or not? Should residuals look normal? Are the * in eacf mean its significant? What should ACF look like for stationarity?

```{r}
library(TSA)
library(tseries)
library(astsa)
library(imputeTS)
library(tsoutliers)
```

Try executing this chunk by clicking the *Run* button within the chunk or by placing your cursor inside it and pressing *Cmd+Shift+Enter*. 

```{r}
terror2 <- read.csv("input/og_num_casualities_greater_than_10.csv")
terror3 <- na.interpolation(terror2$num.attacks, option="spline")
#terror3 <- na.kalman(terror2$num.attacks, model="auto.arima")
cuttoff.index <- length(terror3) - 47 #floor(0.1 * length(terror3))
terror3.valid <- terror3[cuttoff.index : length(terror3)]
terror3 <- terror3[1: cuttoff.index]
ts.plot(ts(terror3))
ts.plot(ts(terror3.valid))
#ts.plot(terror2$num.attacks)
outlier_terror3 <- tso(ts(terror3), types = c("TC", "AO", "IO"))
plot(outlier_terror3)
```

```{r}
terror4 <- outlier_terror3$yadj
#log_terror4 <- log(outlier_terror3$yadj)
adf.test(diff(terror4))
ts.plot(diff(terror4))
ts.plot(diff(diff(terror4)))
```

```{r}
m = floor(sqrt(length(diff(terror4))))
mvspec(diff(terror4), log="no")
mvspec(diff(terror4), kernel('daniell', m), log="no")
#mvspec(diff(log_terror4),  kernel('daniell', m), log="no")
```

```{r}
for 
ts.plot(diff(diff(terror4)))
ts.plot(diff(diff(log_terror4)))
acf(diff(terror4))
pacf(diff(terror4))
```


```{r}
eacf(diff(terror4))
eacf(diff(diff(terror4)))
```

```{r}
#eacf(diff(diff(log_terror4)))
terror5 <- terror4
total_error <- 0
for (i in 1: (length(terror3.valid) - 11))
{
  actual <- terror3.valid[i : i + 11]
  predicted <- sarima.for(terror5, 12, 0, 1, 1, 1, 0, 0, 4)$pre
  total_error <- total_error + sum((actual - predicted)^2)
  terror5 <- c(terror5, terror3.valid[i]) 
}

mse <- total_error / (length(terror3.valid) - 11)

#sarima.for(terror4, 12, 0, 1, 1, 1, 0, 0, 4)$pred

```

```{r}

```
